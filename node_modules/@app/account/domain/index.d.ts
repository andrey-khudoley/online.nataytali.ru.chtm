import { QueryParamsOption } from 'lib/chatium-json'
import { RichUgcAccount } from 'services/ugc-runner/runtime/context/RichUgcCtxAccount'
import { UgcAccount, UgcDomain } from 'services/ugc-runner/runtime/runtimeTypes'
import { PublicFieldsOfClass } from 'utils/types'

declare type Lang = string
declare type AccountUrlFn = {
  accountUrlParams: AccountUrlParams
  (path: string, options?: QueryParamsOption): string
}
interface AccountUrlParams {
  accountName: string
  accountHost: string
  accountPathPrefix: string
  pluginAppInfo?: UgcPluginAppUrlInfo
}
declare type HashMediaType = 'file' | 'video' | 'image' | 'audio'
interface StorageUploadOptions {
  /** upload a non-public file */
  protected?: boolean
  /** allow only these media types (supported: image | video | audio) */
  mediaType?: HashMediaType | HashMediaType[]
  /** allow only these content type pattern(s) */
  contentType?: string | string[]
  /** allow only these file extensions */
  extension?: string | string[]
  /** minimum file size in bytes */
  minBytes?: number
  /** maximum file size in bytes */
  maxBytes?: number
  /** custom auth session authorizing URL expiration time in seconds, default is a week */
  expiresInSeconds?: number
}
declare type AccountAuthType = 'Email' | 'Phone' | 'Multi'
interface UgcPluginAppUrlInfo {
  appSlug: string
  /** path to the application root directory */
  directoryPath: string
}
interface UgcCtxAccount {
  id: number
  name: string
  host: string
  authType: AccountAuthType
  /** @deprecated use host instead */
  externalHost: string | null
  publishedVersion: string | null
  metaHash: string
  pathPrefix: string
}
declare type RequestDomainControlType = typeof validRequestDomainControlTypes[number]
declare const validRequestDomainControlTypes: readonly ['ZoneAndCert', 'OnlyCert', 'ProxiedCert']
declare class DomainHelperClass {
  id: number
  account_id: number
  name: string
  created_at: Date
  is_ready: boolean
  control_type: DomainControlType
  dns_records: DnsRecord[]
  lang: Lang | null
  path_prefix: string
  checked_at: Date
  constructor(
    id: number,
    account_id: number,
    name: string,
    created_at: Date,
    is_ready: boolean,
    control_type: DomainControlType,
    dns_records: DnsRecord[],
    lang: Lang | null,
    path_prefix: string,
    checked_at: Date,
  )
}
export declare type DomainControlType = RequestDomainControlType | 'External'
declare type DnsRecordType = 'A' | 'AAAA' | 'CNAME' | 'TXT' | 'NS' | 'MX' | 'PTR' | 'SRV' | 'CERT'
export interface DnsRecord {
  id: string
  type: DnsRecordType
  name: string
  value: string
  ttl: number
}
declare type Domain = PublicFieldsOfClass<DomainHelperClass>
declare type LogLevel = 'fatal' | 'error' | 'warn' | 'info' | 'debug' | 'trace' | 'unknown'
declare type UgcKvOpts = {
  [key: string]: string | number | undefined
}
declare type LogParams = {
  err?: Error
  kv?: UgcKvOpts
  json?: unknown
  level?: LogLevel
  msg?: string | number
}
declare type LogParamsNoMsg = Omit<LogParams, 'msg'>
export declare function addAccountDomain(ctx: RichUgcCtx, props: AddAccountDomainProps): Promise<UgcDomain>
export declare function setAccountPrimaryDomain(
  ctx: RichUgcCtx,
  { domain: domainOrId, childAccount: childAccountOrId }: SetAccountPrimaryDomainProps,
): Promise<void>
interface AddAccountDomainProps {
  childAccount?: number | UgcAccount | RichUgcAccount
  name: string
  controlType: DomainControlType
  lang?: Lang
  dnsRecords?: DnsRecord[]
  pathPrefix?: string
}
interface SetAccountPrimaryDomainProps {
  domain: number | UgcDomain | null
  childAccount?: number | UgcAccount | RichUgcAccount
}

export { UgcDomain as AccountDomain }

export {}
